<ol class="breadcrumb">
  <li><a href="<%= root_path %>">Home</a></li>
  <li class="active">Search</li>
</ol>

<h1>Search</h1>

<div class="row form-group">
  <div class="col-md-12">
    <%= form_for @search, layout: :basic, method: 'GET', url: { action: :search } do |f| %>
      <%= f.text_field :q, label: 'Search', class: 't-q', placeholder: 'Search by first name, last name, or booking reference.' %>
      <%=
        f.text_field(
          :date_range,
          class: 't-date-range',
          data: {
            module: 'date-range-picker',
            config: {
              autoUpdateInput: false,
              locale: {
                cancelLabel: 'Clear',
                format: 'DD/MM/YYYY'
              }
            }
          }
        )
      %>
      <%= f.submit 'Search', class: 't-search' %>
    <% end %>
  </div>
</div>

<table id="results" class="table table-striped table-bordered table-hover" data-module="SortableList" data-config='{"valueNames": ["id", "created", "first_name", "last_name", "appointment_date", "status"]}' data-default-order='{"value": "created", "order": "desc"}'>
  <thead>
    <tr>
      <th><span class="sort" data-sort="id">Reference</span></th>
      <th><span class="sort" data-sort="created">Created</span></th>
      <th><span class="sort" data-sort="first_name">First Name</span></th>
      <th><span class="sort" data-sort="last_name">Last Name</span></th>
      <th><span class="sort" data-sort="appointment_date">Appointment Date/Time</span></th>
      <th><span class="sort" data-sort="status">Status</span></th>
      <th width="1%">Actions</th>
    </tr>
  </thead>
  <tbody class="list">
    <% @results.each do |result| %>
      <% result = AppointmentPresenter.new(result) %>
      <tr class='t-result'>
        <td class='t-id'><span class="id"><%= result.id %></span></td>
        <td><span class="created"><%= result.created_at %></span></td>
        <td><span class="first_name"><%= result.first_name %></span></td>
        <td><span class="last_name"><%= result.last_name %></span></td>
        <td><span class="appointment_date"><%= result.date %></span></td>
        <td><span class="status"><%= result.status %></span></td>
        <td nowrap="true">
          <%= link_to edit_appointment_path(result), title: 'Edit appointment', class: 'btn btn-info' do %>
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
            <span class="sr-only">Edit appointment</span>
          <% end %>
          <%= link_to appointment_reschedule_path(result), title: 'Reschedule appointment', class: 'btn btn-info' do %>
            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
            <span class="sr-only">Reschedule appointment</span>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= paginate @results %>
